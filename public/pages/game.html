<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cookie Conquest - Multiplayer</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Fredoka+One&display=swap" rel="stylesheet">
    
    <style>
        /* BASE STYLES - FIXED SIZE GAME SCALED TO FIT */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; }
        body { font-family: 'Nunito', sans-serif; background: #0a0a14; color: #fff; display: flex; justify-content: center; align-items: center; }
        
        /* Prevent text selection and cursor throughout game */
        .game-wrapper, .game-wrapper * {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        .game-wrapper { cursor: default; }
        .game-wrapper button { cursor: pointer; }
        .game-wrapper input[type="range"] { cursor: pointer; }
        
        /* Game wrapper - FIXED 1600x900 design, scaled with CSS transform to fit screen */
        .game-wrapper { 
            position: relative; 
            width: 1600px; 
            height: 900px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); 
            overflow: hidden;
            /* Scale will be set by JavaScript on load/resize */
            transform-origin: center center;
        }
        
        .game-container { display: flex; flex-direction: column; width: 100%; height: 100%; overflow: hidden; }
        .game-header { display: flex; justify-content: space-between; align-items: center; padding: 8px 20px; background: rgba(0,0,0,0.4); border-bottom: 1px solid rgba(255,255,255,0.1); flex-shrink: 0; }
        .game-main { display: grid; grid-template-columns: 280px 1fr 280px; gap: 10px; padding: 10px; flex: 1; overflow: hidden; min-height: 0; }
        .game-panel { background: rgba(0,0,0,0.3); border-radius: 15px; padding: 12px; overflow-y: auto; min-height: 0; }
        .panel-left { width: 100%; display: flex; flex-direction: column; }
        .panel-right { width: 100%; }
        .panel-center { display: flex; flex-direction: column; overflow: hidden; background: rgba(0,0,0,0.3); border-radius: 15px; padding: 12px; }
        .match-code { font-weight: 700; color: #f39c12; }
        .header-center { display: flex; align-items: center; gap: 15px; }
        .goal-bar { width: 200px; height: 10px; background: rgba(0,0,0,0.4); border-radius: 5px; overflow: hidden; }
        .goal-fill { height: 100%; background: linear-gradient(90deg, #2ecc71, #f39c12); transition: width 0.3s; }
        .goal-text { font-size: 0.8em; color: #888; }
        .pot-amount { font-weight: 700; }
        
        /* COOKIE AREA */
        .cookie-area { text-align: center; padding: 8px; position: relative; overflow: visible; }
        .big-cookie { width: 90px; height: 90px; border: none; background: none; cursor: pointer; transition: transform 0.1s; position: relative; overflow: visible; }
        .big-cookie:hover { transform: scale(1.05); }
        .big-cookie:active { transform: scale(0.95); }
        .cookie-svg { width: 100%; height: 100%; filter: drop-shadow(0 0 20px rgba(246, 212, 155, 0.5)); }
        .click-indicator { position: absolute; color: #2ecc71; font-weight: bold; font-size: 1.5rem; pointer-events: none; opacity: 0; }
        
        /* KING OF THE HILL */
        .koth-display { padding: 6px; background: rgba(241,196,15,0.1); border-radius: 6px; margin-top: 6px; border: 1px solid rgba(241,196,15,0.3); text-align: center; }
        .koth-title { font-size: 0.65em; color: #f1c40f; margin-bottom: 3px; display: flex; align-items: center; justify-content: center; gap: 4px; }
        .koth-timer-bar { height: 4px; background: rgba(0,0,0,0.3); border-radius: 2px; overflow: hidden; margin: 3px 0; }
        .koth-timer-fill { height: 100%; background: linear-gradient(90deg, #f1c40f, #e67e22); transition: width 0.5s linear; }
        .koth-stats { display: flex; justify-content: space-between; font-size: 0.6em; gap: 4px; }
        .koth-stat { flex: 1; padding: 2px; background: rgba(0,0,0,0.2); border-radius: 3px; }
        .koth-stat-label { color: #888; font-size: 0.85em; }
        .koth-stat-value { color: #f1c40f; font-weight: 700; }
        .koth-buff { font-size: 0.6em; color: #2ecc71; margin-top: 2px; }
        
        /* KOTH ABILITIES */
        .ability-btn { flex: 1; padding: 4px 6px; background: linear-gradient(135deg, #2a4a2a, #1a2e1a); border: 1px solid #3a5a3a; border-radius: 4px; cursor: pointer; color: #fff; font-size: 0.55em; transition: all 0.2s; min-width: 55px; }
        .ability-btn:hover:not(:disabled) { border-color: #2ecc71; transform: scale(1.05); }
        .ability-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .ability-btn.on-cooldown { background: linear-gradient(135deg, #4a2a2a, #2e1a1a); border-color: #5a3a3a; }
        .ability-btn.ability-crash { background: linear-gradient(135deg, #4a2a2a, #2e1a1a); border-color: #e74c3c; }
        .ability-btn.ability-crash:hover:not(:disabled) { border-color: #ff6b6b; box-shadow: 0 0 10px rgba(231,76,60,0.5); }
        
        /* FROZEN OVERLAY */
        .frozen-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(100, 200, 255, 0.3); display: flex; align-items: center; justify-content: center; z-index: 100; pointer-events: none; border-radius: 10px; animation: frozenPulse 1s ease-in-out infinite; }
        .frozen-content { text-align: center; color: #fff; font-size: 2em; font-weight: bold; text-shadow: 0 0 20px #00bfff, 0 0 40px #00bfff; }
        .frozen-timer { font-size: 0.6em; margin-top: 10px; }
        @keyframes frozenPulse { 0%, 100% { background: rgba(100, 200, 255, 0.3); } 50% { background: rgba(100, 200, 255, 0.5); } }
        
        /* INVISIBLE INDICATOR */
        .invisible-indicator { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(155,89,182,0.9); padding: 8px 16px; border-radius: 20px; color: #fff; font-weight: bold; z-index: 1000; animation: invisPulse 1s ease-in-out infinite; }
        @keyframes invisPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        /* STATS */
        .cookie-stats { padding: 8px; background: rgba(0,0,0,0.2); border-radius: 8px; margin-top: 8px; }
        .stat-main { text-align: center; margin-bottom: 6px; }
        .stat-main .stat-label { font-size: 0.75em; color: #888; }
        .stat-main .stat-value { font-size: 1.5em; font-weight: 800; color: #F6D49B; display: block; }
        .stat-goal { text-align: center; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; margin-bottom: 15px; }
        .goal-label { font-size: 0.75em; color: #f39c12; display: block; margin-bottom: 5px; }
        .goal-progress-bar { height: 8px; background: rgba(0,0,0,0.4); border-radius: 4px; overflow: hidden; margin-bottom: 5px; }
        .goal-progress-fill { height: 100%; background: linear-gradient(90deg, #2ecc71, #f39c12); transition: width 0.3s; }
        .goal-percent { font-size: 0.7em; color: #888; }
        .stat-secondary { display: flex; gap: 10px; }
        .stat-item { flex: 1; text-align: center; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 6px; }
        .stat-item .stat-label { font-size: 0.65em; color: #888; display: block; }
        .stat-item .stat-value { font-size: 0.9em; font-weight: 700; color: #2ecc71; }
        .stat-locked-main { text-align: center; padding: 6px; background: rgba(241,196,15,0.1); border-radius: 6px; margin-bottom: 6px; border: 1px solid rgba(241,196,15,0.3); }
        
        /* GENERATORS */
        .generators-list { display: flex; flex-direction: column; gap: 10px; }
        .generator-btn { display: flex; align-items: center; gap: 12px; padding: 12px; background: linear-gradient(135deg, #2a2a4a, #1a1a2e); border: 1px solid #3a3a5a; border-radius: 10px; cursor: pointer; transition: all 0.2s; color: #fff; text-align: left; }
        .generator-btn:hover:not(.locked):not(:disabled) { border-color: #F6D49B; transform: translateX(5px); }
        .generator-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .generator-btn.locked { opacity: 0.4; cursor: not-allowed; filter: grayscale(50%); }
        .generator-btn.locked .cost-value { color: #e74c3c; }
        .gen-icon-svg { flex-shrink: 0; }
        .gen-info { flex: 1; }
        .gen-name { font-weight: 700; display: block; }
        .gen-desc { font-size: 0.75em; color: #888; }
        .gen-cost { text-align: right; }
        .gen-level { font-size: 0.7em; color: #888; display: block; }
        .cost-value { font-weight: 700; color: #F6D49B; }
        
        /* Click Upgrade Section */
        .click-upgrade-section { margin-top: 15px; padding-top: 15px; border-top: 1px dashed #3a3a5a; }
        .click-upgrade-btn { background: linear-gradient(135deg, #4a2a2a, #2e1a1a) !important; border-color: #6a3a3a !important; }
        .click-upgrade-btn:hover:not(.locked) { border-color: #e74c3c !important; }
        .click-upgrade-warning { font-size: 0.7em; color: #e74c3c; text-align: center; margin-top: 8px; opacity: 0.8; }
        
        /* TAB SYSTEM */
        .tab-nav { display: flex; gap: 5px; margin-bottom: 10px; }
        .tab-btn { flex: 1; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid #333; border-radius: 8px; color: #888; cursor: pointer; font-size: 0.8em; }
        .tab-btn.active { background: #f39c12; color: #000; border-color: #f39c12; }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }
        
        /* LIVE POSITIONS */
        .live-positions { margin-top: 6px; padding: 6px; background: rgba(0,0,0,0.2); border-radius: 6px; flex-shrink: 0; }
        .positions-title { font-size: 0.7em; color: #f39c12; margin-bottom: 4px; }
        .no-positions { font-size: 0.65em; color: #555; text-align: center; padding: 4px; }
        .position-item { display: flex; align-items: center; gap: 5px; padding: 6px 8px; background: rgba(0,0,0,0.2); border-radius: 5px; margin-bottom: 4px; font-size: 0.7em; }
        .position-item .trader { color: #F6D49B; font-weight: 600; }
        .position-item .arrow { color: #666; }
        .position-item .target { color: #9b59b6; font-weight: 600; }
        
        /* NOTIFICATION FEED */
        .notification-feed { margin-top: 6px; flex: 1; min-height: 0; display: flex; flex-direction: column; }
        .notif-feed-title { font-size: 0.7em; color: #888; margin-bottom: 4px; flex-shrink: 0; }
        .notif-feed-list { flex: 1; min-height: 60px; max-height: none; overflow-y: auto; }
        .notif-item { padding: 5px 6px; background: rgba(0,0,0,0.2); border-radius: 4px; margin-bottom: 3px; font-size: 0.65em; border-left: 2px solid #3498db; transition: opacity 0.3s; }
        .notif-item.success { border-left-color: #2ecc71; background: rgba(46,204,113,0.1); }
        .notif-item.error { border-left-color: #e74c3c; background: rgba(231,76,60,0.1); }
        .notif-item.warning { border-left-color: #f39c12; background: rgba(243,156,18,0.1); }
        .notif-item.info { border-left-color: #3498db; background: rgba(52,152,219,0.1); }
        
        /* LIVE POSITIONS */
        .live-positions { margin-top: 6px; padding: 6px; background: rgba(0,0,0,0.2); border-radius: 6px; flex-shrink: 0; }
        .live-positions .positions-title { font-size: 0.7em; color: #888; margin-bottom: 4px; display: block; }
        .live-positions .positions-list { max-height: 80px; overflow-y: auto; }
        .live-positions .no-positions { color: #555; font-size: 0.65em; text-align: center; padding: 4px; }
        .live-positions .position-item { display: flex; align-items: center; gap: 4px; padding: 4px 6px; background: rgba(0,0,0,0.2); border-radius: 4px; margin-bottom: 2px; font-size: 0.65em; }
        .live-positions .position-item .trader { color: #aaa; }
        .live-positions .position-item .arrow { color: #666; }
        .live-positions .position-item .target { color: #aaa; }
        .live-positions .position-item.player-position .trader { color: #2ecc71; font-weight: bold; }
        .live-positions .position-item.opponent-on-me .target { color: #e74c3c; font-weight: bold; }
        .live-positions .position-item .pos-pnl-mini { font-size: 0.8em; font-weight: bold; margin-left: auto; }
        .live-positions .position-item .pos-pnl-mini.profit { color: #2ecc71; }
        .live-positions .position-item .pos-pnl-mini.loss { color: #e74c3c; }
        
        /* CHART SYSTEM - DEX Screener Style */
        .scoreboard-with-charts { display: flex; flex-direction: column; height: 100%; min-height: 0; overflow: hidden; }
        .scoreboard-title { flex-shrink: 0; }
        .players-column { display: flex; flex-direction: column; overflow: hidden; min-height: 0; flex: 1; }
        .player-stocks-grid { display: flex; flex-direction: column; gap: 6px; padding: 5px; flex: 1; overflow: hidden; min-height: 0; }
        
        /* Player row: chart on left, positions on right */
        .player-row { display: flex; gap: 8px; flex: 1; min-height: 0; }
        .player-stock-card { background: linear-gradient(180deg, #0d0d1a 0%, #0a0a14 100%); border: 1px solid #2a2a4a; border-radius: 10px; padding: 0; overflow: hidden; flex: 1; min-height: 0; display: flex; flex-direction: column; }
        .chart-container { flex: 1; min-height: 60px; }
        .player-stock-card.you { border-color: #2ecc71; box-shadow: 0 0 20px rgba(46, 204, 113, 0.15); }
        .player-stock-card.tradeable:hover { border-color: #f39c12; box-shadow: 0 0 20px rgba(243, 156, 18, 0.2); }
        
        /* Positions sidebar for each player */
        .player-positions-sidebar { width: 150px; background: rgba(0,0,0,0.4); border-radius: 8px; padding: 6px; display: flex; flex-direction: column; flex-shrink: 0; overflow: hidden; }
        .player-positions-header { font-size: 0.65em; font-weight: bold; color: #f39c12; margin-bottom: 4px; padding-bottom: 4px; border-bottom: 1px solid #2a2a4a; display: flex; justify-content: space-between; align-items: center; }
        .player-positions-pnl { font-size: 0.9em; }
        .player-positions-pnl.profit { color: #2ecc71; }
        .player-positions-pnl.loss { color: #e74c3c; }
        .player-positions-pnl.neutral { color: #888; }
        .player-positions-list { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 3px; }
        .player-pos-item { padding: 4px 5px; background: rgba(0,0,0,0.3); border-radius: 4px; border-left: 2px solid #888; font-size: 0.6em; }
        .player-pos-item.long { border-left-color: #2ecc71; }
        .player-pos-item.short { border-left-color: #e74c3c; }
        .player-pos-item .pos-trader { font-weight: bold; color: #fff; }
        .player-pos-item .pos-type-badge { font-size: 0.85em; padding: 1px 3px; border-radius: 2px; margin-left: 3px; }
        .player-pos-item .pos-type-badge.long { background: rgba(46,204,113,0.3); color: #2ecc71; }
        .player-pos-item .pos-type-badge.short { background: rgba(231,76,60,0.3); color: #e74c3c; }
        .player-pos-item .pos-details-row { display: flex; justify-content: space-between; margin-top: 2px; color: #888; }
        .player-pos-item .pos-pnl-small { font-weight: bold; }
        .player-pos-item .pos-pnl-small.profit { color: #2ecc71; }
        .player-pos-item .pos-pnl-small.loss { color: #e74c3c; }
        .player-pos-item .close-btn-small { margin-top: 3px; width: 100%; padding: 2px; background: #e74c3c; border: none; border-radius: 3px; color: #fff; font-size: 0.9em; font-weight: bold; cursor: pointer; position: relative; z-index: 100; pointer-events: auto !important; }
        .player-pos-item .close-btn-small:hover { filter: brightness(1.2); }
        .no-positions-small { color: #555; font-size: 0.6em; text-align: center; padding: 8px 4px; }
        
        .stock-header { display: flex; align-items: center; justify-content: space-between; padding: 3px 6px; background: rgba(0,0,0,0.3); border-bottom: 1px solid #1a1a2e; flex-shrink: 0; }
        .stock-header-left { display: flex; align-items: center; gap: 4px; }
        .player-rank { background: linear-gradient(135deg, #f39c12, #e67e22); color: #000; font-size: 0.55em; font-weight: 800; padding: 1px 4px; border-radius: 3px; }
        .player-name { font-weight: 700; font-size: 0.75em; }
        .click-indicator { font-size: 0.8em; animation: clickPulse 0.5s ease-out; }
        @keyframes clickPulse { 0% { transform: scale(1.5); opacity: 1; } 100% { transform: scale(1); opacity: 0.8; } }
        .stock-stats { display: flex; flex-direction: row; align-items: center; gap: 6px; }
        .stat-total { font-size: 0.7em; font-weight: 800; color: #f39c12; }
        .stat-networth-small { font-size: 0.65em; color: #9b59b6; }
        .stat-velocity { font-size: 0.6em; padding: 1px 3px; border-radius: 3px; font-weight: 600; }
        .stat-velocity.up { background: rgba(46, 204, 113, 0.2); color: #2ecc71; }
        .stat-velocity.down { background: rgba(231, 76, 60, 0.2); color: #e74c3c; }
        .stat-velocity.flat { background: rgba(150, 150, 150, 0.2); color: #888; }
        .stat-locked { font-size: 0.55em; padding: 1px 3px; border-radius: 3px; font-weight: 600; background: rgba(241, 196, 15, 0.2); color: #f1c40f; }
        
        /* Header ability buttons */
        .header-ability-btn { padding: 3px 6px; border-radius: 4px; font-size: 0.65em; cursor: pointer; transition: all 0.15s; display: inline-flex; align-items: center; gap: 2px; }
        .header-ability-btn .ability-cost { font-size: 0.8em; opacity: 0.8; }
        .header-ability-btn.locked { background: #333; border: 1px solid #555; color: #666; opacity: 0.6; }
        .header-ability-btn.locked:hover { cursor: not-allowed; }
        .header-ability-btn.unlocked { animation: abilityPulse 1.5s infinite; }
        .header-freeze-btn.unlocked { background: linear-gradient(135deg, #0077b6, #00b4d8); border: 1px solid #00bfff; color: #fff; }
        .header-freeze-btn.unlocked:hover { transform: scale(1.1); box-shadow: 0 0 12px rgba(0, 191, 255, 0.7); }
        .header-crash-btn.unlocked { background: linear-gradient(135deg, #8b0000, #dc143c); border: 1px solid #ff4444; color: #fff; }
        .header-crash-btn.unlocked:hover { transform: scale(1.1); box-shadow: 0 0 12px rgba(220, 20, 60, 0.7); }
        @keyframes abilityPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
        
        /* Chart - flex to fill available space in player card */
        .chart-container { position: relative; width: 100%; flex: 1; min-height: 40px; background: #050508; cursor: crosshair; overflow: hidden; }
        .chart-canvas { display: block; width: 100% !important; height: 100% !important; }
        .chart-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; background: linear-gradient(90deg, rgba(5,5,8,0.8) 0%, transparent 15%, transparent 85%, rgba(5,5,8,0.8) 100%); }
        .chart-price { position: absolute; bottom: 4px; right: 6px; font-size: 1em; font-weight: 800; color: #fff; text-shadow: 0 2px 8px rgba(0,0,0,0.8); z-index: 5; pointer-events: none; }
        .chart-change { position: absolute; bottom: 4px; left: 6px; font-size: 0.65em; font-weight: 700; padding: 2px 5px; border-radius: 4px; z-index: 5; pointer-events: none; }
        .chart-change.up { background: #2ecc71; color: #000; }
        .chart-change.down { background: #e74c3c; color: #fff; }
        .chart-change.flat { background: #555; color: #fff; }
        
        /* Trade controls - compact */
        .card-actions { padding: 4px 6px; background: rgba(0,0,0,0.2); border-top: 1px solid #1a1a2e; flex-shrink: 0; }
        .trade-controls { display: flex; gap: 3px; align-items: center; margin-bottom: 4px; }
        .leverage-select { display: flex; gap: 2px; flex-wrap: wrap; flex: 1; }
        .lev-btn { padding: 2px 4px; background: #1a1a2e; border: 1px solid #333; border-radius: 3px; color: #888; font-size: 0.55em; font-weight: bold; cursor: pointer; transition: all 0.1s; }
        .lev-btn:hover { background: #252540; border-color: #555; }
        .lev-btn.active { background: #f39c12; color: #000; border-color: #f39c12; }
        
        /* Stake slider row */
        .stake-slider-row { display: flex; align-items: center; gap: 4px; margin-bottom: 4px; padding: 2px 0; }
        .stake-label { font-size: 0.6em; color: #888; font-weight: 600; }
        .stake-slider { flex: 1; height: 8px; -webkit-appearance: none; appearance: none; background: linear-gradient(90deg, #1a1a2e, #2a2a4a); border-radius: 4px; outline: none; cursor: pointer; transition: background 0.2s; }
        .stake-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 16px; height: 16px; background: linear-gradient(135deg, #f39c12, #e67e22); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.3); transition: transform 0.15s ease-out; }
        .stake-slider::-webkit-slider-thumb:hover { transform: scale(1.15); }
        .stake-slider::-webkit-slider-thumb:active { transform: scale(0.95); }
        .stake-slider::-moz-range-thumb { width: 16px; height: 16px; background: linear-gradient(135deg, #f39c12, #e67e22); border-radius: 50%; cursor: pointer; border: none; box-shadow: 0 2px 6px rgba(0,0,0,0.3); }
        .stake-slider:disabled { opacity: 0.4; cursor: not-allowed; }
        .stake-slider:disabled::-webkit-slider-thumb { background: #666; cursor: not-allowed; }
        .stake-value { font-size: 0.6em; color: #f39c12; font-weight: 700; min-width: 35px; text-align: right; }
        .max-stake-btn { padding: 2px 5px; background: #1a1a2e; border: 1px solid #555; border-radius: 3px; color: #888; font-size: 0.5em; font-weight: bold; cursor: pointer; transition: all 0.15s; }
        .max-stake-btn:hover { background: #252540; border-color: #f39c12; color: #f39c12; }
        .max-stake-btn.active { background: #f39c12; color: #000; border-color: #f39c12; }
        .quick-trade-btns { display: flex; gap: 4px; }
        .quick-trade-btn { flex: 1; padding: 6px 4px; border: none; border-radius: 4px; font-size: 0.7em; font-weight: bold; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 1px; min-width: 50px; }
        .quick-trade-btn.long { background: linear-gradient(135deg, #27ae60, #2ecc71); color: #fff; }
        .quick-trade-btn.short { background: linear-gradient(135deg, #c0392b, #e74c3c); color: #fff; }
        .quick-trade-btn:hover { filter: brightness(1.15); transform: scale(1.02); }
        .quick-trade-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }
        .quick-trade-btn .btn-label { font-size: 0.9em; font-weight: 800; }
        .quick-trade-btn .btn-leverage { font-size: 0.65em; opacity: 0.8; }
        
        /* Active position on card - compact */
        .active-position { margin-top: 4px; padding: 4px 6px; background: linear-gradient(135deg, rgba(0,0,0,0.4), rgba(0,0,0,0.2)); border-radius: 4px; border-left: 3px solid #f39c12; display: none; flex-shrink: 0; }
        .active-position.show { display: block; }
        .active-position.long { border-left-color: #2ecc71; }
        .active-position.short { border-left-color: #e74c3c; }
        .pos-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2px; }
        .pos-type { font-size: 0.6em; font-weight: bold; padding: 1px 4px; border-radius: 3px; }
        .pos-type.long { background: #2ecc71; color: #000; }
        .pos-type.short { background: #e74c3c; color: #fff; }
        .pos-pnl { font-size: 0.7em; font-weight: bold; }
        .pos-pnl.profit { color: #2ecc71; }
        .pos-pnl.loss { color: #e74c3c; }
        .pos-details { display: flex; justify-content: space-between; font-size: 0.55em; color: #888; margin-bottom: 2px; }
        .pos-close-btn { width: 100%; padding: 3px; background: #e74c3c; border: none; border-radius: 3px; color: #fff; font-size: 0.55em; font-weight: bold; cursor: pointer; }
        .pos-close-btn:hover { filter: brightness(1.2); }
        
        /* Positions on me section - compact */
        .positions-on-me-section { margin-top: 4px; padding: 4px 6px; background: rgba(0,0,0,0.3); border-radius: 4px; flex-shrink: 0; }
        .positions-on-me-header { font-size: 0.65em; font-weight: bold; color: #f39c12; margin-bottom: 3px; }
        .positions-on-me-list { max-height: 60px; overflow-y: auto; }
        .no-positions-on-me { font-size: 0.6em; color: #666; text-align: center; padding: 4px; }
        .position-on-me-item { display: flex; justify-content: space-between; align-items: center; padding: 2px 4px; margin-bottom: 2px; background: rgba(0,0,0,0.2); border-radius: 3px; font-size: 0.6em; border-left: 2px solid #888; }
        .position-on-me-item.long { border-left-color: #2ecc71; }
        .position-on-me-item.short { border-left-color: #e74c3c; }
        .pom-trader { font-weight: bold; color: #e74c3c; }
        .pom-type { font-size: 0.85em; padding: 1px 4px; border-radius: 2px; }
        .pom-type.long { background: rgba(46,204,113,0.3); color: #2ecc71; }
        .pom-type.short { background: rgba(231,76,60,0.3); color: #e74c3c; }
        .pom-stake { color: #f39c12; }
        .pom-pnl { font-weight: bold; }
        .pom-pnl.positive { color: #2ecc71; }
        .pom-pnl.negative { color: #e74c3c; }
        
        /* Scoreboard */
        .scoreboard-title { display: flex; align-items: center; gap: 10px; color: #f39c12; font-size: 1em; margin: 0 0 8px 0; padding: 8px; background: rgba(0,0,0,0.3); border-radius: 8px; }
        .total-pnl { margin-left: auto; font-size: 0.85em; padding: 4px 8px; background: #1a1a2e; border-radius: 4px; }
        .leave-btn { width: 100%; margin-top: 8px; padding: 8px; background: linear-gradient(135deg, #c0392b, #e74c3c); border: none; border-radius: 8px; color: #fff; font-weight: bold; font-size: 0.8em; cursor: pointer; flex-shrink: 0; }
        
        /* Loading overlay */
        .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1a1a2e; z-index: 2000; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .loading-overlay.hidden { display: none; }
        .loading-spinner { font-size: 4rem; animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .loading-text { margin-top: 20px; font-size: 1.2rem; color: #888; }
        
        /* Victory overlay */
        .victory-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 1000; justify-content: center; align-items: center; flex-direction: column; }
        .victory-overlay.show { display: flex; }
        .victory-content { text-align: center; }
        .victory-emoji { font-size: 6rem; margin-bottom: 20px; }
        .victory-title { font-size: 3rem; font-weight: 800; color: #F6D49B; margin-bottom: 10px; }
        .victory-subtitle { font-size: 1.5rem; color: #888; margin-bottom: 30px; }
        .victory-btn { padding: 15px 40px; background: linear-gradient(135deg, #F6D49B, #E8A954); border: none; border-radius: 10px; color: #1a1a2e; font-size: 1.2rem; font-weight: 700; cursor: pointer; }
        .victory-modal { background: linear-gradient(135deg, #1a1a2e, #0a0a14); padding: 40px; border-radius: 20px; border: 2px solid #f39c12; text-align: center; }
        .victory-icon { font-size: 5rem; margin-bottom: 20px; }
        .victory-winner { font-size: 1.2rem; color: #888; margin-bottom: 20px; }
        .victory-cookies { font-size: 2rem; color: #F6D49B; margin-bottom: 20px; }
        
        /* Click feedback */
        .click-feedback { position: absolute; color: #2ecc71; font-weight: bold; font-size: 1.5rem; pointer-events: none; animation: floatUp 0.8s ease-out forwards; z-index: 100; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-50px); } }
        @keyframes toastSlideIn { 0% { opacity: 0; transform: translateX(100px); } 100% { opacity: 1; transform: translateX(0); } }
        @keyframes toastSlideOut { 0% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; transform: translateX(100px); } }
        
        /* Positions list in sidebar */
        .position-row { display: flex; align-items: center; gap: 8px; padding: 8px 10px; background: rgba(0,0,0,0.2); border-radius: 6px; margin-bottom: 5px; }
        .pos-icon { font-size: 1.2em; }
        .pos-icon.long { color: #2ecc71; }
        .pos-icon.short { color: #e74c3c; }
        .pos-info { flex: 1; }
        .pos-name { font-weight: 600; font-size: 0.85em; }
        .pos-meta { font-size: 0.65em; color: #888; }
        .pos-liq { font-size: 0.65em; }
        .pos-liq.safe { color: #2ecc71; }
        .pos-liq.warning { color: #f39c12; }
        .pos-liq.danger { color: #e74c3c; }
        .pos-values { text-align: right; }
        .pos-current-pnl { font-weight: 700; font-size: 0.85em; }
        .pos-current-pnl.profit { color: #2ecc71; }
        .pos-current-pnl.loss { color: #e74c3c; }
        .pos-stake { font-size: 0.65em; color: #f1c40f; }
        .pos-actions { margin-left: 5px; position: relative; z-index: 200; }
        .pos-action-btn { padding: 4px 8px; border: none; border-radius: 4px; font-size: 0.65em; font-weight: bold; cursor: pointer; }
        .pos-action-btn.close { background: #e74c3c; color: #fff; }
        .pos-action-btn:hover { filter: brightness(1.2); }
        .close-position-btn { padding: 6px 12px; background: #e74c3c; border: none; border-radius: 4px; color: #fff; font-size: 0.75em; font-weight: bold; cursor: pointer; transition: all 0.2s; position: relative; z-index: 300; pointer-events: auto !important; }
        .close-position-btn:hover { background: #c0392b; transform: scale(1.05); }
        .positions-pnl { font-weight: 700; }
        .positions-pnl.profit { color: #2ecc71; }
        .positions-pnl.loss { color: #e74c3c; }
        .positions-pnl.neutral { color: #888; }
        
        /* Positions panel in sidebar */
        .positions-panel-content { padding: 0; }
        .positions-header { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; margin-bottom: 10px; }
        .positions-title { font-size: 0.9em; font-weight: bold; color: #f39c12; }
        .positions-list { }
        .position-row { display: flex; align-items: center; gap: 8px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; margin-bottom: 8px; border-left: 3px solid #f39c12; }
        .position-row.long { border-left-color: #2ecc71; }\n        .position-row.short { border-left-color: #e74c3c; }
        
        /* Positions panel in CENTER (like tutorial) */
        .positions-panel { background: transparent; border: none; border-radius: 10px; padding: 0; margin-top: 0; flex-shrink: 0; }
        .positions-panel .positions-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; padding-bottom: 6px; border-bottom: 1px solid #2a2a4a; }
        .positions-panel .positions-title { font-size: 0.85em; font-weight: bold; color: #f39c12; }
        .positions-panel .positions-list { }
        /* Compact position rows for center panel */
        .positions-section .position-row { flex-wrap: wrap; padding: 6px 8px; gap: 4px; margin-bottom: 6px; }
        .positions-section .pos-icon { font-size: 0.9em; }
        .positions-section .pos-info { flex: 1; min-width: 100px; }
        .positions-section .pos-name { font-size: 0.75em; }
        .positions-section .pos-meta { font-size: 0.55em; white-space: nowrap; }
        .positions-section .pos-liq { font-size: 0.55em; }
        .positions-section .pos-values { text-align: right; min-width: 50px; }
        .positions-section .pos-current-pnl { font-size: 0.75em; }
        .positions-section .pos-stake { font-size: 0.55em; }
        .positions-section .pos-actions { width: 100%; margin-top: 4px; margin-left: 0; }
        .positions-section .close-position-btn { width: 100%; padding: 4px 6px; font-size: 0.65em; }
        
        /* Chart controls */
        .chart-controls { display: flex; gap: 3px; justify-content: center; padding: 4px 0; opacity: 0.8; }
        .player-stock-card:hover .chart-controls { opacity: 1; }
        .zoom-btn { padding: 4px 8px; background: rgba(0,0,0,0.7); border: 1px solid #333; border-radius: 3px; color: #888; font-size: 0.65em; cursor: pointer; }
        .zoom-btn:hover { background: #333; color: #fff; }
        .zoom-btn.zoom-live { background: #e74c3c; color: #fff; }
        .zoom-btn.zoom-live:hover { background: #c0392b; }
        .zoom-btn.zoom-all { background: #3498db; color: #fff; }
        .zoom-btn.zoom-all:hover { background: #2980b9; }
        
        /* Stock header row */
        .stock-header-row { display: flex; align-items: center; gap: 8px; padding: 4px 12px; background: rgba(0,0,0,0.2); font-size: 0.75em; }
        .stat-label { color: #666; }
        .stat-value { color: #f39c12; font-weight: 600; }
        
        /* My card info */
        .my-card-info { display: flex; justify-content: space-between; padding: 10px 12px; background: rgba(0,0,0,0.3); }
        .locked-margin span { color: #f1c40f; font-weight: 600; }
        
        /* Stake input group */
        .stake-input-group { display: flex; align-items: center; gap: 4px; margin-bottom: 6px; }
        .stake-input-group label { font-size: 0.7em; color: #888; }
        .trade-buttons { display: flex; gap: 6px; }
        
        /* No media queries - fixed size for everyone */
        
        /* Remote cursors */
        .remote-cursor { display: flex; align-items: flex-start; gap: 2px; }
        .cursor-label { font-size: 0.7em; font-weight: 700; color: #fff; padding: 2px 6px; border-radius: 4px; white-space: nowrap; margin-top: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.5); }
        
        /* Screen tint overlay for money gain/loss */
        .screen-tint {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.15s ease-out;
        }
        .screen-tint.green {
            background: radial-gradient(ellipse at center, rgba(46, 204, 113, 0.4) 0%, rgba(46, 204, 113, 0.2) 50%, transparent 80%);
            box-shadow: inset 0 0 100px rgba(46, 204, 113, 0.5);
        }
        .screen-tint.red {
            background: radial-gradient(ellipse at center, rgba(231, 76, 60, 0.4) 0%, rgba(231, 76, 60, 0.2) 50%, transparent 80%);
            box-shadow: inset 0 0 100px rgba(231, 76, 60, 0.5);
        }
        .screen-tint.active {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Screen tint overlay -->
    <div class="screen-tint" id="screen-tint"></div>
    
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner">üç™</div>
        <div class="loading-text" id="loading-text">Connecting to game...</div>
    </div>
    
    <div class="victory-overlay" id="victory">
        <div class="victory-content">
            <div class="victory-emoji" id="victory-emoji">üèÜ</div>
            <div class="victory-title" id="victory-title">Victory!</div>
            <div class="victory-subtitle" id="victory-subtitle">Player won!</div>
            <button class="victory-btn" onclick="window.location.href='/'">Back to Lobby</button>
        </div>
    </div>

    <div id="game-wrapper" class="game-wrapper">
    <div id="game-container" class="game-container">
        <header class="game-header">
            <div class="header-left">
                <span class="match-code" id="lobby-code">LOBBY: ----</span>
            </div>
            <div class="header-center">
                <span class="pot-amount" style="color: #2ecc71;">COOKIE CONQUEST</span>
            </div>
            <div class="header-right">
                <span class="pot-amount" style="color: #888;">MULTIPLAYER</span>
            </div>
        </header>

        <main class="game-main">
            <!-- Left Panel -->
            <section class="game-panel panel-left">
                <div class="cookie-area">
                    <button class="big-cookie" id="big-cookie">
                        <svg class="cookie-svg" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="46" fill="#D2691E"/>
                            <circle cx="50" cy="50" r="43" fill="#CD853F"/>
                            <circle cx="50" cy="50" r="40" fill="#DEB887"/>
                            <circle cx="30" cy="35" r="6" fill="#5D3A1A"/>
                            <circle cx="55" cy="28" r="5" fill="#5D3A1A"/>
                            <circle cx="72" cy="45" r="6" fill="#5D3A1A"/>
                            <circle cx="62" cy="68" r="5" fill="#5D3A1A"/>
                            <circle cx="38" cy="62" r="6" fill="#5D3A1A"/>
                            <circle cx="25" cy="52" r="4" fill="#5D3A1A"/>
                            <circle cx="48" cy="50" r="4" fill="#5D3A1A"/>
                        </svg>
                    </button>
                    <div class="cookie-cps-display" style="margin-top: 4px; text-align: center;" id="cookie-cps">
                        <div style="font-size: 0.7em; color: #2ecc71;">üñ±Ô∏è 0 cookies/sec</div>
                        <div style="font-size: 0.7em; color: #f39c12;">üè≠ +0 from generators</div>
                    </div>
                    
                    <!-- King of the Hill Display -->
                    <div class="koth-display" id="koth-display">
                        <div class="koth-title">üëë King of the Hill</div>
                        <div class="koth-timer-bar">
                            <div class="koth-timer-fill" id="koth-timer-fill" style="width: 100%;"></div>
                        </div>
                        <div class="koth-stats">
                            <div class="koth-stat">
                                <div class="koth-stat-label">‚è±Ô∏è Time Left</div>
                                <div class="koth-stat-value" id="koth-time-left">60s</div>
                            </div>
                            <div class="koth-stat">
                                <div class="koth-stat-label">üèÜ Your Time</div>
                                <div class="koth-stat-value" id="koth-your-time">0s</div>
                            </div>
                        </div>
                        
                        <!-- KotH Leaderboard -->
                        <div class="koth-leaderboard" id="koth-leaderboard" style="margin-top: 4px; padding-top: 4px; border-top: 1px dashed rgba(241,196,15,0.3);">
                            <div style="font-size: 0.55em; color: #f1c40f; margin-bottom: 2px;">üìä Standings:</div>
                            <div id="koth-leaderboard-list" style="font-size: 0.55em; max-height: 45px; overflow-y: auto;"></div>
                        </div>
                        
                        <div class="koth-buff" id="koth-buff-display">No ability points yet</div>
                        
                        <!-- Abilities -->
                        <div class="koth-abilities" id="koth-abilities" style="display: none; margin-top: 4px; padding-top: 4px; border-top: 1px dashed rgba(241,196,15,0.3);">
                            <div style="font-size: 0.55em; color: #f1c40f; margin-bottom: 3px;">‚ö° Abilities:</div>
                            <div style="display: flex; gap: 3px; flex-wrap: wrap;">
                                <button class="ability-btn" id="ability-freeze" title="Freeze a player for 15s (1 pt)">
                                    ü•∂ Freeze <span style="opacity:0.7">(1)</span>
                                </button>
                                <button class="ability-btn" id="ability-invisible" title="Go invisible for 15s (1 pt)">
                                    üëª Invis <span style="opacity:0.7">(1)</span>
                                </button>
                                <button class="ability-btn ability-crash" id="ability-crash" title="Target loses 10% cookies (2 pts)">
                                    üìâ Crash <span style="opacity:0.7">(2)</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frozen overlay -->
                    <div class="frozen-overlay" id="frozen-overlay" style="display: none;">
                        <div class="frozen-content">
                            ü•∂ FROZEN!
                            <div class="frozen-timer" id="frozen-timer">15s</div>
                        </div>
                    </div>
                </div>

                <div class="cookie-stats">
                    <div class="stat-main">
                        <span class="stat-label">Your Cookies</span>
                        <span class="stat-value" id="cookie-count">0</span>
                    </div>
                    <div class="stat-real-balance" style="text-align: center; padding: 5px; background: rgba(231,76,60,0.1); border-radius: 6px; margin-bottom: 6px; border: 1px solid rgba(231,76,60,0.3); display: none;" id="real-balance-container">
                        <span class="stat-label" style="color: #e74c3c; font-size: 0.65em;">‚ö†Ô∏è Real Balance</span>
                        <span class="stat-value" id="real-balance-value" style="color: #e74c3c; font-size: 0.9em; display: block; font-weight: 700;">0</span>
                        <span class="stat-label" style="color: #e74c3c; font-size: 0.6em; display: inline;">üíé Real NW: </span>
                        <span class="stat-value" id="real-networth-value" style="color: #e74c3c; font-size: 0.85em; display: inline; font-weight: 700;">0</span>
                    </div>
                    <div class="stat-networth" style="text-align: center; padding: 5px; background: rgba(155,89,182,0.15); border-radius: 6px; margin-bottom: 6px; border: 1px solid rgba(155,89,182,0.3);">
                        <span class="stat-label" style="color: #9b59b6; font-size: 0.7em;">üíé Net Worth</span>
                        <span class="stat-value" id="networth-value" style="color: #9b59b6; font-size: 1em; display: block;">0</span>
                    </div>
                    <div class="stat-locked-main" id="locked-display">
                        <span class="stat-label" style="color: #f1c40f; font-size: 0.7em;">üîí Locked</span>
                        <span class="stat-value" id="locked-value" style="color: #f1c40f; font-size: 0.9em;">0</span>
                    </div>
                </div>
                
                <!-- Live Positions -->
                <div class="live-positions">
                    <h4 class="positions-title">üìä Live Positions</h4>
                    <div class="positions-list" id="live-positions-list">
                        <div class="no-positions">No open positions</div>
                    </div>
                </div>
                
                <div class="notification-feed">
                    <h4 class="notif-feed-title">üì¢ Activity Feed</h4>
                    <div class="notif-feed-list" id="notif-feed"></div>
                </div>
                
                <button class="leave-btn" id="give-up-btn" style="margin-top: auto;">üè≥Ô∏è GIVE UP</button>
            </section>

            <!-- Center Panel - Players with per-player positions -->
            <section class="game-panel panel-center">
                <div class="scoreboard-with-charts" id="scoreboard">
                    <div class="players-column">
                        <h3 class="scoreboard-title" style="justify-content: space-between; display: flex; margin-bottom: 8px;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="#F6D49B">
                                    <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
                                </svg>
                                Stock Market
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="color: #f39c12; font-size: 0.85em;">üèÜ 100M</span>
                                <div class="goal-bar" style="width: 80px;">
                                    <div class="goal-fill" id="goal-fill" style="width: 0%"></div>
                                </div>
                                <span style="color: #888; font-size: 0.8em;" id="goal-percent">0%</span>
                            </div>
                        </h3>
                        
                        <div class="player-stocks-grid" id="players-grid">
                            <!-- Player rows rendered dynamically (card + positions sidebar) -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Panel -->
            <section class="game-panel panel-right">
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="generators">Generators</button>
                    <button class="tab-btn" data-tab="help">Help</button>
                </div>

                <div class="tab-panel active" id="generators-panel">
                    <div class="generators-list">
                        <button class="generator-btn" id="generator-grandma" data-generator="grandma">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <circle cx="12" cy="8" r="5" fill="#DEB887"/>
                                <path d="M4 20c0-4 4-6 8-6s8 2 8 6v2H4v-2z" fill="#8B4513"/>
                                <circle cx="10" cy="7" r="1" fill="#333"/>
                                <circle cx="14" cy="7" r="1" fill="#333"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Grandma</span>
                                <span class="gen-desc">+1 cookie/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">15</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-bakery" data-generator="bakery">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <rect x="4" y="10" width="16" height="10" rx="2" fill="#8B4513"/>
                                <rect x="6" y="6" width="12" height="6" fill="#CD853F"/>
                                <rect x="8" y="12" width="3" height="4" fill="#FFE4B5"/>
                                <rect x="13" y="12" width="3" height="4" fill="#FFE4B5"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Bakery</span>
                                <span class="gen-desc">+5 cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">100</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-factory" data-generator="factory">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <rect x="2" y="12" width="20" height="10" fill="#666"/>
                                <rect x="4" y="8" width="4" height="8" fill="#888"/>
                                <rect x="10" y="6" width="4" height="10" fill="#888"/>
                                <rect x="16" y="4" width="4" height="12" fill="#888"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Factory</span>
                                <span class="gen-desc">+20 cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">500</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-mine" data-generator="mine">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <path d="M12 2L2 12h3v10h14V12h3L12 2z" fill="#5D4037"/>
                                <rect x="9" y="14" width="6" height="6" fill="#3E2723"/>
                                <circle cx="12" cy="8" r="2" fill="#FFD54F"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Mine</span>
                                <span class="gen-desc">+100 cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">2000</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-bank" data-generator="bank">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <path d="M12 2L2 8v2h20V8L12 2z" fill="#78909C"/>
                                <rect x="4" y="10" width="16" height="10" fill="#607D8B"/>
                                <rect x="6" y="12" width="3" height="6" fill="#455A64"/>
                                <rect x="10.5" y="12" width="3" height="6" fill="#455A64"/>
                                <rect x="15" y="12" width="3" height="6" fill="#455A64"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Bank</span>
                                <span class="gen-desc">+500 cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">10000</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-temple" data-generator="temple">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <path d="M12 2L4 8v2h16V8L12 2z" fill="#FDD835"/>
                                <rect x="5" y="10" width="14" height="10" fill="#F9A825"/>
                                <rect x="10" y="12" width="4" height="8" fill="#5D4037"/>
                                <circle cx="12" cy="6" r="2" fill="#FF6F00"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Temple</span>
                                <span class="gen-desc">+2.5K cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">50000</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-wizard" data-generator="wizard">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <path d="M12 2l2 7h7l-5.5 4 2 7L12 16l-5.5 4 2-7L3 9h7z" fill="#9b59b6"/>
                                <rect x="10" y="14" width="4" height="8" fill="#8e44ad"/>
                                <circle cx="12" cy="8" r="3" fill="#e74c3c"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Wizard Tower</span>
                                <span class="gen-desc">+10K cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">200000</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-portal" data-generator="portal">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <ellipse cx="12" cy="12" rx="10" ry="8" fill="none" stroke="#3498db" stroke-width="3"/>
                                <ellipse cx="12" cy="12" rx="6" ry="4" fill="#2980b9"/>
                                <circle cx="12" cy="12" r="2" fill="#1abc9c"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Portal</span>
                                <span class="gen-desc">+50K cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">1000000</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-prism" data-generator="prism">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <polygon points="12,2 22,20 2,20" fill="url(#prismGrad)"/>
                                <defs>
                                    <linearGradient id="prismGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#e74c3c"/>
                                        <stop offset="33%" style="stop-color:#f39c12"/>
                                        <stop offset="66%" style="stop-color:#2ecc71"/>
                                        <stop offset="100%" style="stop-color:#3498db"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Prism</span>
                                <span class="gen-desc">+250K cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">5000000</span>
                            </div>
                        </button>
                        <button class="generator-btn" id="generator-universe" data-generator="universe">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" fill="#1a1a2e"/>
                                <circle cx="8" cy="8" r="1.5" fill="#fff"/>
                                <circle cx="16" cy="10" r="1" fill="#f39c12"/>
                                <circle cx="14" cy="16" r="1.2" fill="#3498db"/>
                                <circle cx="6" cy="14" r="0.8" fill="#e74c3c"/>
                                <circle cx="12" cy="12" r="3" fill="#9b59b6"/>
                                <ellipse cx="12" cy="12" rx="8" ry="2" fill="none" stroke="#f39c12" stroke-width="0.5" opacity="0.5"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Cookie Universe</span>
                                <span class="gen-desc">+1M cookies/sec</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level">Lv.0</span>
                                <span class="cost-value">25000000</span>
                            </div>
                        </button>
                    </div>
                    
                    <!-- Click Power Upgrade -->
                    <div class="click-upgrade-section">
                        <button class="generator-btn click-upgrade-btn" id="upgrade-click">
                            <svg class="gen-icon-svg" width="32" height="32" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" fill="#e74c3c"/>
                                <path d="M12 6v12M6 12h12" stroke="#fff" stroke-width="2"/>
                            </svg>
                            <div class="gen-info">
                                <span class="gen-name">Click Power</span>
                                <span class="gen-desc click-power-desc">+1 per click ‚Üí +2</span>
                            </div>
                            <div class="gen-cost">
                                <span class="gen-level click-power-level">Lv.1</span>
                                <span class="cost-value click-power-cost">50</span>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="tab-panel" id="help-panel">
                    <div style="padding: 15px; color: #aaa; font-size: 0.85em;">
                        <h4 style="color: #f39c12; margin: 0 0 15px 0;">üìà How Trading Works</h4>
                        <div style="margin-bottom: 15px; padding: 10px; background: rgba(39, 174, 96, 0.2); border-radius: 8px;">
                            <strong style="color: #27ae60;">LONG</strong>
                            <p style="margin: 5px 0 0 0;">Bet cookies will GO UP. Profit when chart rises!</p>
                        </div>
                        <div style="margin-bottom: 15px; padding: 10px; background: rgba(192, 57, 43, 0.2); border-radius: 8px;">
                            <strong style="color: #c0392b;">SHORT</strong>
                            <p style="margin: 5px 0 0 0;">Bet cookies will GO DOWN. Profit when chart falls!</p>
                        </div>
                        <div style="padding: 10px; background: rgba(243, 156, 18, 0.2); border-radius: 8px;">
                            <strong style="color: #f39c12;">LEVERAGE</strong>
                            <p style="margin: 5px 0 0 0;">Higher leverage = bigger gains AND losses!</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    </div>

    <script>
        // Scale the fixed-size game wrapper to fit the screen
        function scaleGameWrapper() {
            const wrapper = document.getElementById('game-wrapper');
            if (!wrapper) return;
            
            const designWidth = 1600;
            const designHeight = 900;
            
            const scaleX = window.innerWidth / designWidth;
            const scaleY = window.innerHeight / designHeight;
            const scale = Math.min(scaleX, scaleY);
            
            // Use zoom instead of transform for better scroll handling
            wrapper.style.zoom = scale;
            wrapper.style.transform = 'none';
        }
        
        // Scale on load and resize
        window.addEventListener('load', scaleGameWrapper);
        window.addEventListener('resize', scaleGameWrapper);
        scaleGameWrapper();
    </script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/game-client.js"></script>
</body>
</html>
